{
  "enrichWithDeltaNum": "SELECT account_id FROM (SELECT account_id FROM (SELECT accounts_actual.account_id, accounts_actual.account_type, t1.transaction_id, t1.transaction_date, t1.account_id AS account_id0, t1.amount FROM local__shares.accounts_actual FINAL INNER JOIN (SELECT transaction_id, transaction_date, account_id, amount FROM local__shares.transactions_actual_shard FINAL WHERE sys_from <= 1 AND sys_to >= 1) AS t1 ON accounts_actual.account_id = t1.account_id WHERE accounts_actual.sys_from <= 1 AND accounts_actual.sys_to >= 1) AS t4 WHERE t4.account_id = 10) AS t7 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NOT NULL OR (((SELECT 1 AS r FROM local__shares.transactions_actual_shard WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT account_id FROM (SELECT account_id FROM (SELECT accounts_actual1.account_id, accounts_actual1.account_type, t20.transaction_id, t20.transaction_date, t20.account_id AS account_id0, t20.amount FROM local__shares.accounts_actual AS accounts_actual1 INNER JOIN (SELECT transaction_id, transaction_date, account_id, amount FROM local__shares.transactions_actual_shard WHERE sys_from <= 1 AND sys_to >= 1) AS t20 ON accounts_actual1.account_id = t20.account_id WHERE accounts_actual1.sys_from <= 1 AND accounts_actual1.sys_to >= 1) AS t23 WHERE t23.account_id = 10) AS t26 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NULL AND (((SELECT 1 AS r FROM local__shares.transactions_actual_shard WHERE sign < 0 LIMIT 1))) IS NULL",
  "enrichWithDeltaNum2": "SELECT account_id FROM (SELECT accounts_actual.account_id FROM local__shares.accounts_actual FINAL INNER JOIN (SELECT transaction_id, transaction_date, account_id, amount FROM local__shares.transactions_actual_shard FINAL WHERE sys_from <= 1 AND sys_to >= 1) AS t1 ON accounts_actual.account_id = t1.account_id WHERE accounts_actual.sys_from <= 1 AND accounts_actual.sys_to >= 1) AS t4 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NOT NULL OR (((SELECT 1 AS r FROM local__shares.transactions_actual_shard WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT account_id FROM (SELECT accounts_actual1.account_id FROM local__shares.accounts_actual AS accounts_actual1 INNER JOIN (SELECT transaction_id, transaction_date, account_id, amount FROM local__shares.transactions_actual_shard WHERE sys_from <= 1 AND sys_to >= 1) AS t17 ON accounts_actual1.account_id = t17.account_id WHERE accounts_actual1.sys_from <= 1 AND accounts_actual1.sys_to >= 1) AS t20 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NULL AND (((SELECT 1 AS r FROM local__shares.transactions_actual_shard WHERE sign < 0 LIMIT 1))) IS NULL",
  "enrichWithDeltaNum3": "SELECT account_id, __f1, account_type, __f3 FROM (SELECT accounts_actual.account_id, COALESCE(SUM(t1.amount), 0) AS __f1, accounts_actual.account_type, CASE WHEN accounts_actual.account_type = 'D' AND COALESCE(SUM(t1.amount), 0) >= 0 OR accounts_actual.account_type = 'C' AND COALESCE(SUM(t1.amount), 0) <= 0 THEN 'OK' ELSE 'NOT OK' END AS __f3 FROM local__shares.accounts_actual FINAL LEFT JOIN (SELECT transaction_id, transaction_date, account_id, amount FROM local__shares.transactions_actual_shard FINAL WHERE sys_from <= 1 AND sys_to >= 1) AS t1 ON accounts_actual.account_id = t1.account_id WHERE accounts_actual.sys_from <= 1 AND accounts_actual.sys_to >= 1 GROUP BY accounts_actual.account_id, accounts_actual.account_type) AS t6 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NOT NULL OR (((SELECT 1 AS r FROM local__shares.transactions_actual_shard WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT account_id, __f1, account_type, __f3 FROM (SELECT accounts_actual1.account_id, COALESCE(SUM(t19.amount), 0) AS __f1, accounts_actual1.account_type, CASE WHEN accounts_actual1.account_type = 'D' AND COALESCE(SUM(t19.amount), 0) >= 0 OR accounts_actual1.account_type = 'C' AND COALESCE(SUM(t19.amount), 0) <= 0 THEN 'OK' ELSE 'NOT OK' END AS __f3 FROM local__shares.accounts_actual AS accounts_actual1 LEFT JOIN (SELECT transaction_id, transaction_date, account_id, amount FROM local__shares.transactions_actual_shard WHERE sys_from <= 1 AND sys_to >= 1) AS t19 ON accounts_actual1.account_id = t19.account_id WHERE accounts_actual1.sys_from <= 1 AND accounts_actual1.sys_to >= 1 GROUP BY accounts_actual1.account_id, accounts_actual1.account_type) AS t24 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NULL AND (((SELECT 1 AS r FROM local__shares.transactions_actual_shard WHERE sign < 0 LIMIT 1))) IS NULL",
  "enrichWithDeltaNum4": "SELECT transaction_id, transaction_date, account_id, amount FROM (SELECT transaction_id, transaction_date, account_id, amount FROM local__shares.transactions_actual FINAL WHERE sys_from <= 1 AND sys_to >= 1) AS t1 WHERE (((SELECT 1 AS r FROM local__shares.transactions_actual WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT transaction_id, transaction_date, account_id, amount FROM (SELECT transaction_id, transaction_date, account_id, amount FROM local__shares.transactions_actual WHERE sys_from <= 1 AND sys_to >= 1) AS t10 WHERE (((SELECT 1 AS r FROM local__shares.transactions_actual WHERE sign < 0 LIMIT 1))) IS NULL",
  "enrichWithDeltaNum5": "SELECT account_id FROM (SELECT t1.account_id FROM (SELECT account_id FROM local__shares.accounts_actual FINAL WHERE sys_from <= 1 AND (sys_to >= 1 AND account_id = 12)) AS t1 INNER JOIN local__shares.transactions_actual_shard FINAL ON t1.account_id = transactions_actual_shard.account_id WHERE transactions_actual_shard.sys_from <= 1 AND transactions_actual_shard.sys_to >= 1) AS t4 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NOT NULL OR (((SELECT 1 AS r FROM local__shares.transactions_actual_shard WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT account_id FROM (SELECT t17.account_id FROM (SELECT account_id FROM local__shares.accounts_actual WHERE sys_from <= 1 AND (sys_to >= 1 AND account_id = 12)) AS t17 INNER JOIN local__shares.transactions_actual_shard AS transactions_actual_shard1 ON t17.account_id = transactions_actual_shard1.account_id WHERE transactions_actual_shard1.sys_from <= 1 AND transactions_actual_shard1.sys_to >= 1) AS t20 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NULL AND (((SELECT 1 AS r FROM local__shares.transactions_actual_shard WHERE sign < 0 LIMIT 1))) IS NULL",
  "enrichWithDeltaNum6": "SELECT account_id FROM (SELECT accounts_actual.account_id FROM local__shares.accounts_actual FINAL INNER JOIN (SELECT transaction_id, transaction_date, account_id, amount FROM local__shares.transactions_actual_shard FINAL WHERE sys_from <= 1 AND sys_to >= 1) AS t1 ON accounts_actual.account_id = t1.account_id WHERE accounts_actual.sys_from <= 1 AND accounts_actual.sys_to >= 1 LIMIT 10) AS t5 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NOT NULL OR (((SELECT 1 AS r FROM local__shares.transactions_actual_shard WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT account_id FROM (SELECT accounts_actual1.account_id FROM local__shares.accounts_actual AS accounts_actual1 INNER JOIN (SELECT transaction_id, transaction_date, account_id, amount FROM local__shares.transactions_actual_shard WHERE sys_from <= 1 AND sys_to >= 1) AS t18 ON accounts_actual1.account_id = t18.account_id WHERE accounts_actual1.sys_from <= 1 AND accounts_actual1.sys_to >= 1 LIMIT 10) AS t22 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NULL AND (((SELECT 1 AS r FROM local__shares.transactions_actual_shard WHERE sign < 0 LIMIT 1))) IS NULL",
  "enrichCount": "SELECT COUNT(*) AS EXPR__0 FROM (SELECT __f0 FROM (SELECT 0 AS __f0 FROM local__shares.accounts_actual FINAL WHERE sys_from <= 1 AND sys_to >= 1) AS t1 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT __f0 FROM (SELECT 0 AS __f0 FROM local__shares.accounts_actual WHERE sys_from <= 1 AND sys_to >= 1) AS t10 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NULL) AS t17",
  "enrichWithDeltaNum9": "SELECT transaction_id, transaction_date, account_id, amount FROM (SELECT transaction_id, transaction_date, account_id, amount FROM local__shares.transactions_actual FINAL WHERE sys_from <= 1 AND (sys_to >= 1 AND account_id = 1)) AS t1 WHERE (((SELECT 1 AS r FROM local__shares.transactions_actual WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT transaction_id, transaction_date, account_id, amount FROM (SELECT transaction_id, transaction_date, account_id, amount FROM local__shares.transactions_actual WHERE sys_from <= 1 AND (sys_to >= 1 AND account_id = 1)) AS t10 WHERE (((SELECT 1 AS r FROM local__shares.transactions_actual WHERE sign < 0 LIMIT 1))) IS NULL",
  "enrichWithAggregate": "SELECT min_col, max_col, varchar_col FROM (SELECT MIN(int_col) AS min_col, MIN(double_col) AS max_col, varchar_col FROM local__dml.aggregation_table_actual FINAL WHERE sys_from <= 1 AND sys_to >= 1 GROUP BY varchar_col ORDER BY varchar_col NULLS LAST LIMIT 2) AS t5 WHERE (((SELECT 1 AS r FROM local__dml.aggregation_table_actual WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT min_col, max_col, varchar_col FROM (SELECT MIN(int_col) AS min_col, MIN(double_col) AS max_col, varchar_col FROM local__dml.aggregation_table_actual WHERE sys_from <= 1 AND sys_to >= 1 GROUP BY varchar_col ORDER BY varchar_col NULLS LAST LIMIT 2) AS t18 WHERE (((SELECT 1 AS r FROM local__dml.aggregation_table_actual WHERE sign < 0 LIMIT 1))) IS NULL",
  "enrichWithAggregate2": "SELECT min_col, max_col, varchar_col, __f3 FROM (SELECT MIN(int_col) AS min_col, MIN(double_col) AS max_col, varchar_col, NULL AS __f3 FROM local__dml.aggregation_table_actual FINAL WHERE sys_from <= 1 AND (sys_to >= 1 AND varchar_col = 'ф') GROUP BY varchar_col LIMIT 2) AS t4 WHERE (((SELECT 1 AS r FROM local__dml.aggregation_table_actual WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT min_col, max_col, varchar_col, __f3 FROM (SELECT MIN(int_col) AS min_col, MIN(double_col) AS max_col, varchar_col, NULL AS __f3 FROM local__dml.aggregation_table_actual WHERE sys_from <= 1 AND (sys_to >= 1 AND varchar_col = 'ф') GROUP BY varchar_col LIMIT 2) AS t16 WHERE (((SELECT 1 AS r FROM local__dml.aggregation_table_actual WHERE sign < 0 LIMIT 1))) IS NULL",
  "enrichWithSort": "SELECT EXPR__0, category_name, EXPR__2, id0 FROM (SELECT COUNT(t1.category_name) AS EXPR__0, t1.category_name, SUM(products_actual.units_in_stock) AS EXPR__2, t1.id AS id0 FROM local__dml.products_actual FINAL INNER JOIN (SELECT id, category_name, description FROM local__dml.categories_actual_shard FINAL WHERE sys_from <= 1 AND sys_to >= 1) AS t1 ON products_actual.category_id = t1.id WHERE products_actual.sys_from <= 1 AND products_actual.sys_to >= 1 GROUP BY t1.category_name, t1.id ORDER BY t1.id NULLS LAST LIMIT 5) AS t8 WHERE (((SELECT 1 AS r FROM local__dml.products_actual WHERE sign < 0 LIMIT 1))) IS NOT NULL OR (((SELECT 1 AS r FROM local__dml.categories_actual_shard WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT EXPR__0, category_name, EXPR__2, id0 FROM (SELECT COUNT(t21.category_name) AS EXPR__0, t21.category_name, SUM(products_actual1.units_in_stock) AS EXPR__2, t21.id AS id0 FROM local__dml.products_actual AS products_actual1 INNER JOIN (SELECT id, category_name, description FROM local__dml.categories_actual_shard WHERE sys_from <= 1 AND sys_to >= 1) AS t21 ON products_actual1.category_id = t21.id WHERE products_actual1.sys_from <= 1 AND products_actual1.sys_to >= 1 GROUP BY t21.category_name, t21.id ORDER BY t21.id NULLS LAST LIMIT 5) AS t28 WHERE (((SELECT 1 AS r FROM local__dml.products_actual WHERE sign < 0 LIMIT 1))) IS NULL AND (((SELECT 1 AS r FROM local__dml.categories_actual_shard WHERE sign < 0 LIMIT 1))) IS NULL",
  "enrichWithSort3": "SELECT EXPR__0, category_name, id0, EXPR__3 FROM (SELECT COUNT(t1.category_name) AS EXPR__0, t1.category_name, t1.id AS id0, SUM(products_actual.units_in_stock) AS EXPR__3 FROM local__dml.products_actual FINAL INNER JOIN (SELECT id, category_name, description FROM local__dml.categories_actual_shard FINAL WHERE sys_from <= 1 AND sys_to >= 1) AS t1 ON products_actual.category_id = t1.id WHERE products_actual.sys_from <= 1 AND products_actual.sys_to >= 1 GROUP BY t1.category_name, t1.id ORDER BY t1.id NULLS LAST LIMIT 5) AS t8 WHERE (((SELECT 1 AS r FROM local__dml.products_actual WHERE sign < 0 LIMIT 1))) IS NOT NULL OR (((SELECT 1 AS r FROM local__dml.categories_actual_shard WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT EXPR__0, category_name, id0, EXPR__3 FROM (SELECT COUNT(t21.category_name) AS EXPR__0, t21.category_name, t21.id AS id0, SUM(products_actual1.units_in_stock) AS EXPR__3 FROM local__dml.products_actual AS products_actual1 INNER JOIN (SELECT id, category_name, description FROM local__dml.categories_actual_shard WHERE sys_from <= 1 AND sys_to >= 1) AS t21 ON products_actual1.category_id = t21.id WHERE products_actual1.sys_from <= 1 AND products_actual1.sys_to >= 1 GROUP BY t21.category_name, t21.id ORDER BY t21.id NULLS LAST LIMIT 5) AS t28 WHERE (((SELECT 1 AS r FROM local__dml.products_actual WHERE sign < 0 LIMIT 1))) IS NULL AND (((SELECT 1 AS r FROM local__dml.categories_actual_shard WHERE sign < 0 LIMIT 1))) IS NULL",
  "enrichWithSort4": "SELECT EXPR__0, EXPR__1 FROM (SELECT t8.EXPR__0, t8.EXPR__1 FROM (SELECT COUNT(t1.category_name) AS EXPR__0, SUM(products_actual.units_in_stock) AS EXPR__1, t1.id AS id0 FROM local__dml.products_actual FINAL INNER JOIN (SELECT id, category_name, description FROM local__dml.categories_actual_shard FINAL WHERE sys_from <= 1 AND sys_to >= 1) AS t1 ON products_actual.category_id = t1.id WHERE products_actual.sys_from <= 1 AND products_actual.sys_to >= 1 GROUP BY t1.category_name, t1.id ORDER BY t1.id NULLS LAST LIMIT 5) AS t8) AS t9 WHERE (((SELECT 1 AS r FROM local__dml.products_actual WHERE sign < 0 LIMIT 1))) IS NOT NULL OR (((SELECT 1 AS r FROM local__dml.categories_actual_shard WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT EXPR__0, EXPR__1 FROM (SELECT t29.EXPR__0, t29.EXPR__1 FROM (SELECT COUNT(t22.category_name) AS EXPR__0, SUM(products_actual1.units_in_stock) AS EXPR__1, t22.id AS id0 FROM local__dml.products_actual AS products_actual1 INNER JOIN (SELECT id, category_name, description FROM local__dml.categories_actual_shard WHERE sys_from <= 1 AND sys_to >= 1) AS t22 ON products_actual1.category_id = t22.id WHERE products_actual1.sys_from <= 1 AND products_actual1.sys_to >= 1 GROUP BY t22.category_name, t22.id ORDER BY t22.id NULLS LAST LIMIT 5) AS t29) AS t30 WHERE (((SELECT 1 AS r FROM local__dml.products_actual WHERE sign < 0 LIMIT 1))) IS NULL AND (((SELECT 1 AS r FROM local__dml.categories_actual_shard WHERE sign < 0 LIMIT 1))) IS NULL",
  "enrichWithSort5": "SELECT id0 FROM (SELECT t1.id AS id0 FROM local__dml.products_actual FINAL INNER JOIN (SELECT id, category_name, description FROM local__dml.categories_actual_shard FINAL WHERE sys_from <= 1 AND sys_to >= 1) AS t1 ON products_actual.category_id = t1.id WHERE products_actual.sys_from <= 1 AND products_actual.sys_to >= 1 ORDER BY t1.id NULLS LAST) AS t5 WHERE (((SELECT 1 AS r FROM local__dml.products_actual WHERE sign < 0 LIMIT 1))) IS NOT NULL OR (((SELECT 1 AS r FROM local__dml.categories_actual_shard WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT id0 FROM (SELECT t18.id AS id0 FROM local__dml.products_actual AS products_actual1 INNER JOIN (SELECT id, category_name, description FROM local__dml.categories_actual_shard WHERE sys_from <= 1 AND sys_to >= 1) AS t18 ON products_actual1.category_id = t18.id WHERE products_actual1.sys_from <= 1 AND products_actual1.sys_to >= 1 ORDER BY t18.id NULLS LAST) AS t22 WHERE (((SELECT 1 AS r FROM local__dml.products_actual WHERE sign < 0 LIMIT 1))) IS NULL AND (((SELECT 1 AS r FROM local__dml.categories_actual_shard WHERE sign < 0 LIMIT 1))) IS NULL",
  "enrichWithSort6": "SELECT id, category_name, description, id0, product_name, category_id, unit_price, units_in_stock, discontinued FROM (SELECT categories_actual.id, categories_actual.category_name, categories_actual.description, t1.id AS id0, t1.product_name, t1.category_id, t1.unit_price, t1.units_in_stock, t1.discontinued FROM local__dml.categories_actual FINAL INNER JOIN (SELECT id, product_name, category_id, unit_price, units_in_stock, discontinued FROM local__dml.products_actual_shard FINAL WHERE sys_from <= 1 AND sys_to >= 1) AS t1 ON categories_actual.id = t1.category_id WHERE categories_actual.sys_from <= 1 AND categories_actual.sys_to >= 1 ORDER BY categories_actual.id NULLS LAST, t1.product_name DESC NULLS FIRST) AS t5 WHERE (((SELECT 1 AS r FROM local__dml.categories_actual WHERE sign < 0 LIMIT 1))) IS NOT NULL OR (((SELECT 1 AS r FROM local__dml.products_actual_shard WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT id, category_name, description, id0, product_name, category_id, unit_price, units_in_stock, discontinued FROM (SELECT categories_actual1.id, categories_actual1.category_name, categories_actual1.description, t18.id AS id0, t18.product_name, t18.category_id, t18.unit_price, t18.units_in_stock, t18.discontinued FROM local__dml.categories_actual AS categories_actual1 INNER JOIN (SELECT id, product_name, category_id, unit_price, units_in_stock, discontinued FROM local__dml.products_actual_shard WHERE sys_from <= 1 AND sys_to >= 1) AS t18 ON categories_actual1.id = t18.category_id WHERE categories_actual1.sys_from <= 1 AND categories_actual1.sys_to >= 1 ORDER BY categories_actual1.id NULLS LAST, t18.product_name DESC NULLS FIRST) AS t22 WHERE (((SELECT 1 AS r FROM local__dml.categories_actual WHERE sign < 0 LIMIT 1))) IS NULL AND (((SELECT 1 AS r FROM local__dml.products_actual_shard WHERE sign < 0 LIMIT 1))) IS NULL",
  "enrichWithManyInKeyword": "SELECT account_id FROM (SELECT account_id FROM local__shares.accounts_actual FINAL WHERE sys_from <= 1 AND (sys_to >= 1 AND (account_id = 1 OR account_id = 2 OR (account_id = 3 OR (account_id = 4 OR account_id = 5)) OR (account_id = 6 OR (account_id = 7 OR account_id = 8) OR (account_id = 9 OR (account_id = 10 OR account_id = 11))) OR (account_id = 12 OR (account_id = 13 OR account_id = 14) OR (account_id = 15 OR (account_id = 16 OR account_id = 17)) OR (account_id = 18 OR (account_id = 19 OR account_id = 20) OR (account_id = 21 OR (account_id = 22 OR account_id = 23))))))) AS t1 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT account_id FROM (SELECT account_id FROM local__shares.accounts_actual WHERE sys_from <= 1 AND (sys_to >= 1 AND (account_id = 1 OR account_id = 2 OR (account_id = 3 OR (account_id = 4 OR account_id = 5)) OR (account_id = 6 OR (account_id = 7 OR account_id = 8) OR (account_id = 9 OR (account_id = 10 OR account_id = 11))) OR (account_id = 12 OR (account_id = 13 OR account_id = 14) OR (account_id = 15 OR (account_id = 16 OR account_id = 17)) OR (account_id = 18 OR (account_id = 19 OR account_id = 20) OR (account_id = 21 OR (account_id = 22 OR account_id = 23))))))) AS t10 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NULL",
  "enrichWithCustomSelect": "SELECT account_id, account_type, __f2 FROM (SELECT account_id, account_type, 0 AS __f2 FROM local__shares.accounts_actual FINAL WHERE sys_from <= 1 AND sys_to >= 1 ORDER BY account_id NULLS LAST) AS t2 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT account_id, account_type, __f2 FROM (SELECT account_id, account_type, 0 AS __f2 FROM local__shares.accounts_actual WHERE sys_from <= 1 AND sys_to >= 1 ORDER BY account_id NULLS LAST) AS t12 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NULL",
  "enrichWithSubquery": "SELECT account_id, account_type FROM (SELECT account_id, account_type FROM local__shares.accounts_actual FINAL WHERE sys_from <= 1 AND (sys_to >= 1 AND account_id IN (SELECT account_id FROM local__shares.transactions_actual_shard FINAL WHERE sys_from <= 2 AND sys_to >= 2 LIMIT 1))) AS t5 WHERE (((SELECT 1 AS r FROM local__shares.transactions_actual_shard WHERE sign < 0 LIMIT 1))) IS NOT NULL OR (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT account_id, account_type FROM (SELECT account_id, account_type FROM local__shares.accounts_actual WHERE sys_from <= 1 AND (sys_to >= 1 AND account_id IN (SELECT account_id FROM local__shares.transactions_actual_shard WHERE sys_from <= 2 AND sys_to >= 2 LIMIT 1))) AS t22 WHERE (((SELECT 1 AS r FROM local__shares.transactions_actual_shard WHERE sign < 0 LIMIT 1))) IS NULL AND (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NULL",
  "enrichWithSubqueryInJoin": "SELECT account_id, account_type, account_id0 FROM (SELECT account_id, account_type, account_id0 FROM (SELECT accounts_actual.account_id, accounts_actual.account_type, t1.account_id AS account_id0 FROM local__shares.accounts_actual FINAL INNER JOIN (SELECT account_id FROM local__shares.transactions_actual_shard FINAL WHERE sys_from <= 2 AND sys_to >= 2) AS t1 ON accounts_actual.account_id = t1.account_id WHERE accounts_actual.sys_from <= 1 AND accounts_actual.sys_to >= 1) AS t4 WHERE t4.account_id > 0 LIMIT 1) AS t7 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NOT NULL OR (((SELECT 1 AS r FROM local__shares.transactions_actual_shard WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT account_id, account_type, account_id0 FROM (SELECT account_id, account_type, account_id0 FROM (SELECT accounts_actual1.account_id, accounts_actual1.account_type, t20.account_id AS account_id0 FROM local__shares.accounts_actual AS accounts_actual1 INNER JOIN (SELECT account_id FROM local__shares.transactions_actual_shard WHERE sys_from <= 2 AND sys_to >= 2) AS t20 ON accounts_actual1.account_id = t20.account_id WHERE accounts_actual1.sys_from <= 1 AND accounts_actual1.sys_to >= 1) AS t23 WHERE t23.account_id > 0 LIMIT 1) AS t26 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NULL AND (((SELECT 1 AS r FROM local__shares.transactions_actual_shard WHERE sign < 0 LIMIT 1))) IS NULL",
  "enrichWithDeltaFinishedIn": "SELECT account_id FROM (SELECT account_id FROM (SELECT accounts_actual.account_id, accounts_actual.account_type, t1.transaction_id, t1.transaction_date, t1.account_id AS account_id0, t1.amount FROM local__shares.accounts_actual FINAL INNER JOIN (SELECT transaction_id, transaction_date, account_id, amount FROM local__shares.transactions_actual_shard FINAL WHERE sys_to >= 1 AND (sys_to <= 1 AND sys_op = 1)) AS t1 ON accounts_actual.account_id = t1.account_id WHERE accounts_actual.sys_to >= 0 AND (accounts_actual.sys_to <= 0 AND accounts_actual.sys_op = 1)) AS t4 WHERE t4.account_id = 10) AS t7 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NOT NULL OR (((SELECT 1 AS r FROM local__shares.transactions_actual_shard WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT account_id FROM (SELECT account_id FROM (SELECT accounts_actual1.account_id, accounts_actual1.account_type, t20.transaction_id, t20.transaction_date, t20.account_id AS account_id0, t20.amount FROM local__shares.accounts_actual AS accounts_actual1 INNER JOIN (SELECT transaction_id, transaction_date, account_id, amount FROM local__shares.transactions_actual_shard WHERE sys_to >= 1 AND (sys_to <= 1 AND sys_op = 1)) AS t20 ON accounts_actual1.account_id = t20.account_id WHERE accounts_actual1.sys_to >= 0 AND (accounts_actual1.sys_to <= 0 AND accounts_actual1.sys_op = 1)) AS t23 WHERE t23.account_id = 10) AS t26 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NULL AND (((SELECT 1 AS r FROM local__shares.transactions_actual_shard WHERE sign < 0 LIMIT 1))) IS NULL",
  "enrichWithDeltaStartedIn": "SELECT account_id FROM (SELECT account_id FROM (SELECT accounts_actual.account_id, accounts_actual.account_type, t1.transaction_id, t1.transaction_date, t1.account_id AS account_id0, t1.amount FROM local__shares.accounts_actual FINAL INNER JOIN (SELECT transaction_id, transaction_date, account_id, amount FROM local__shares.transactions_actual_shard FINAL WHERE sys_from >= 2 AND sys_from <= 2) AS t1 ON accounts_actual.account_id = t1.account_id WHERE accounts_actual.sys_from >= 1 AND accounts_actual.sys_from <= 1) AS t4 WHERE t4.account_id = 10) AS t7 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NOT NULL OR (((SELECT 1 AS r FROM local__shares.transactions_actual_shard WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT account_id FROM (SELECT account_id FROM (SELECT accounts_actual1.account_id, accounts_actual1.account_type, t20.transaction_id, t20.transaction_date, t20.account_id AS account_id0, t20.amount FROM local__shares.accounts_actual AS accounts_actual1 INNER JOIN (SELECT transaction_id, transaction_date, account_id, amount FROM local__shares.transactions_actual_shard WHERE sys_from >= 2 AND sys_from <= 2) AS t20 ON accounts_actual1.account_id = t20.account_id WHERE accounts_actual1.sys_from >= 1 AND accounts_actual1.sys_from <= 1) AS t23 WHERE t23.account_id = 10) AS t26 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NULL AND (((SELECT 1 AS r FROM local__shares.transactions_actual_shard WHERE sign < 0 LIMIT 1))) IS NULL",
  "enrichWithDeltaOnDate": "SELECT account_id FROM (SELECT account_id FROM (SELECT accounts_actual.account_id, accounts_actual.account_type, t1.transaction_id, t1.transaction_date, t1.account_id AS account_id0, t1.amount FROM local__shares.accounts_actual FINAL INNER JOIN (SELECT transaction_id, transaction_date, account_id, amount FROM local__shares.transactions_actual_shard FINAL WHERE sys_from <= 2 AND sys_to >= 2) AS t1 ON accounts_actual.account_id = t1.account_id WHERE accounts_actual.sys_from <= 1 AND accounts_actual.sys_to >= 1) AS t4 WHERE t4.account_id = 10) AS t7 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NOT NULL OR (((SELECT 1 AS r FROM local__shares.transactions_actual_shard WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT account_id FROM (SELECT account_id FROM (SELECT accounts_actual1.account_id, accounts_actual1.account_type, t20.transaction_id, t20.transaction_date, t20.account_id AS account_id0, t20.amount FROM local__shares.accounts_actual AS accounts_actual1 INNER JOIN (SELECT transaction_id, transaction_date, account_id, amount FROM local__shares.transactions_actual_shard WHERE sys_from <= 2 AND sys_to >= 2) AS t20 ON accounts_actual1.account_id = t20.account_id WHERE accounts_actual1.sys_from <= 1 AND accounts_actual1.sys_to >= 1) AS t23 WHERE t23.account_id = 10) AS t26 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NULL AND (((SELECT 1 AS r FROM local__shares.transactions_actual_shard WHERE sign < 0 LIMIT 1))) IS NULL",
  "enrichWithWithoutDelta": "SELECT account_id FROM (SELECT account_id FROM (SELECT accounts_actual.account_id, accounts_actual.account_type, t1.transaction_id, t1.transaction_date, t1.account_id AS account_id0, t1.amount FROM local__shares.accounts_actual FINAL INNER JOIN (SELECT transaction_id, transaction_date, account_id, amount FROM local__shares.transactions_actual_shard FINAL WHERE sys_from <= 2 AND sys_to >= 2) AS t1 ON accounts_actual.account_id = t1.account_id WHERE accounts_actual.sys_from <= 1 AND accounts_actual.sys_to >= 1) AS t4 WHERE t4.account_id = 10) AS t7 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NOT NULL OR (((SELECT 1 AS r FROM local__shares.transactions_actual_shard WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT account_id FROM (SELECT account_id FROM (SELECT accounts_actual1.account_id, accounts_actual1.account_type, t20.transaction_id, t20.transaction_date, t20.account_id AS account_id0, t20.amount FROM local__shares.accounts_actual AS accounts_actual1 INNER JOIN (SELECT transaction_id, transaction_date, account_id, amount FROM local__shares.transactions_actual_shard WHERE sys_from <= 2 AND sys_to >= 2) AS t20 ON accounts_actual1.account_id = t20.account_id WHERE accounts_actual1.sys_from <= 1 AND accounts_actual1.sys_to >= 1) AS t23 WHERE t23.account_id = 10) AS t26 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NULL AND (((SELECT 1 AS r FROM local__shares.transactions_actual_shard WHERE sign < 0 LIMIT 1))) IS NULL",
  "enrichWithAliasesAndFunctions": "SELECT account_id, __f1, __f2, __f3, __f4, transaction_id, transaction_date, account_id0, amount FROM (SELECT account_id, __f1, __f2, __f3, __f4, transaction_id, transaction_date, account_id0, amount FROM (SELECT t1.account_id, t1.__f1, t1.__f2, t1.__f3, t1.__f4, t4.transaction_id, t4.transaction_date, t4.account_id AS account_id0, t4.amount FROM (SELECT account_id, TRUE AS __f1, ABS(account_id) AS __f2, 'some$' AS __f3, '$some' AS __f4 FROM local__shares.accounts_actual FINAL WHERE sys_from <= 2 AND sys_to >= 2) AS t1 INNER JOIN (SELECT transaction_id, transaction_date, account_id, amount, ABS(account_id) AS __f4 FROM local__shares.transactions_actual_shard FINAL WHERE sys_from <= 1 AND sys_to >= 1) AS t4 ON t1.account_id = t4.account_id AND t1.__f2 = t4.__f4) AS t5 WHERE t5.__f1 = TRUE AND t5.__f2 = 0) AS t7 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NOT NULL OR (((SELECT 1 AS r FROM local__shares.transactions_actual_shard WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT account_id, __f1, __f2, __f3, __f4, transaction_id, transaction_date, account_id0, amount FROM (SELECT account_id, __f1, __f2, __f3, __f4, transaction_id, transaction_date, account_id0, amount FROM (SELECT t20.account_id, t20.__f1, t20.__f2, t20.__f3, t20.__f4, t23.transaction_id, t23.transaction_date, t23.account_id AS account_id0, t23.amount FROM (SELECT account_id, TRUE AS __f1, ABS(account_id) AS __f2, 'some$' AS __f3, '$some' AS __f4 FROM local__shares.accounts_actual WHERE sys_from <= 2 AND sys_to >= 2) AS t20 INNER JOIN (SELECT transaction_id, transaction_date, account_id, amount, ABS(account_id) AS __f4 FROM local__shares.transactions_actual_shard WHERE sys_from <= 1 AND sys_to >= 1) AS t23 ON t20.account_id = t23.account_id AND t20.__f2 = t23.__f4) AS t24 WHERE t24.__f1 = TRUE AND t24.__f2 = 0) AS t26 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NULL AND (((SELECT 1 AS r FROM local__shares.transactions_actual_shard WHERE sign < 0 LIMIT 1))) IS NULL",
  "shouldBeShardedWhenLocal": "SELECT account_id FROM (SELECT account_id FROM (SELECT accounts_actual_shard.account_id, accounts_actual_shard.account_type, t1.transaction_id, t1.transaction_date, t1.account_id AS account_id0, t1.amount FROM local__shares.accounts_actual_shard FINAL INNER JOIN (SELECT transaction_id, transaction_date, account_id, amount FROM local__shares.transactions_actual_shard FINAL WHERE sys_from <= 1 AND sys_to >= 1) AS t1 ON accounts_actual_shard.account_id = t1.account_id WHERE accounts_actual_shard.sys_from <= 1 AND accounts_actual_shard.sys_to >= 1) AS t4 WHERE t4.account_id = 10) AS t7 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual_shard WHERE sign < 0 LIMIT 1))) IS NOT NULL OR (((SELECT 1 AS r FROM local__shares.transactions_actual_shard WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT account_id FROM (SELECT account_id FROM (SELECT accounts_actual_shard1.account_id, accounts_actual_shard1.account_type, t20.transaction_id, t20.transaction_date, t20.account_id AS account_id0, t20.amount FROM local__shares.accounts_actual_shard AS accounts_actual_shard1 INNER JOIN (SELECT transaction_id, transaction_date, account_id, amount FROM local__shares.transactions_actual_shard WHERE sys_from <= 1 AND sys_to >= 1) AS t20 ON accounts_actual_shard1.account_id = t20.account_id WHERE accounts_actual_shard1.sys_from <= 1 AND accounts_actual_shard1.sys_to >= 1) AS t23 WHERE t23.account_id = 10) AS t26 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual_shard WHERE sign < 0 LIMIT 1))) IS NULL AND (((SELECT 1 AS r FROM local__shares.transactions_actual_shard WHERE sign < 0 LIMIT 1))) IS NULL"
}