{
  "enrichWithDeltaNum": "SELECT account_id FROM (SELECT accounts_actual.account_id FROM local__shares.accounts_actual FINAL INNER JOIN (SELECT transaction_id, transaction_date, account_id, amount, sys_op, sys_to, sys_from, sign, sys_close_date FROM local__shares.transactions_actual_shard FINAL WHERE sys_from <= 1 AND sys_to >= 1) AS t0 ON accounts_actual.account_id = t0.account_id WHERE accounts_actual.account_id = 10 AND (accounts_actual.sys_from <= 1 AND accounts_actual.sys_to >= 1)) AS t3 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NOT NULL OR (((SELECT 1 AS r FROM local__shares.transactions_actual_shard WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT account_id FROM (SELECT accounts_actual1.account_id FROM local__shares.accounts_actual AS accounts_actual1 INNER JOIN (SELECT transaction_id, transaction_date, account_id, amount, sys_op, sys_to, sys_from, sign, sys_close_date FROM local__shares.transactions_actual_shard WHERE sys_from <= 1 AND sys_to >= 1) AS t15 ON accounts_actual1.account_id = t15.account_id WHERE accounts_actual1.account_id = 10 AND (accounts_actual1.sys_from <= 1 AND accounts_actual1.sys_to >= 1)) AS t18 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NULL AND (((SELECT 1 AS r FROM local__shares.transactions_actual_shard WHERE sign < 0 LIMIT 1))) IS NULL",
  "enrichWithDeltaNum2": "SELECT account_id FROM (SELECT accounts_actual.account_id FROM local__shares.accounts_actual FINAL INNER JOIN (SELECT transaction_id, transaction_date, account_id, amount, sys_op, sys_to, sys_from, sign, sys_close_date FROM local__shares.transactions_actual_shard FINAL WHERE sys_from <= 1 AND sys_to >= 1) AS t0 ON accounts_actual.account_id = t0.account_id WHERE accounts_actual.sys_from <= 1 AND accounts_actual.sys_to >= 1) AS t3 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NOT NULL OR (((SELECT 1 AS r FROM local__shares.transactions_actual_shard WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT account_id FROM (SELECT accounts_actual1.account_id FROM local__shares.accounts_actual AS accounts_actual1 INNER JOIN (SELECT transaction_id, transaction_date, account_id, amount, sys_op, sys_to, sys_from, sign, sys_close_date FROM local__shares.transactions_actual_shard WHERE sys_from <= 1 AND sys_to >= 1) AS t15 ON accounts_actual1.account_id = t15.account_id WHERE accounts_actual1.sys_from <= 1 AND accounts_actual1.sys_to >= 1) AS t18 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NULL AND (((SELECT 1 AS r FROM local__shares.transactions_actual_shard WHERE sign < 0 LIMIT 1))) IS NULL",
  "enrichWithDeltaNum3": "SELECT account_id, __f1, account_type, __f3 FROM (SELECT accounts_actual.account_id, COALESCE(SUM(t0.amount), 0) AS __f1, accounts_actual.account_type, CASE WHEN accounts_actual.account_type = 'D' AND COALESCE(SUM(t0.amount), 0) >= 0 OR accounts_actual.account_type = 'C' AND COALESCE(SUM(t0.amount), 0) <= 0 THEN 'OK' ELSE 'NOT OK' END AS __f3 FROM local__shares.accounts_actual FINAL LEFT JOIN (SELECT transaction_id, transaction_date, account_id, amount, sys_op, sys_to, sys_from, sign, sys_close_date FROM local__shares.transactions_actual_shard FINAL WHERE sys_from <= 1 AND sys_to >= 1) AS t0 ON accounts_actual.account_id = t0.account_id WHERE accounts_actual.sys_from <= 1 AND accounts_actual.sys_to >= 1 GROUP BY accounts_actual.account_id, accounts_actual.account_type) AS t5 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NOT NULL OR (((SELECT 1 AS r FROM local__shares.transactions_actual_shard WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT account_id, __f1, account_type, __f3 FROM (SELECT accounts_actual1.account_id, COALESCE(SUM(t17.amount), 0) AS __f1, accounts_actual1.account_type, CASE WHEN accounts_actual1.account_type = 'D' AND COALESCE(SUM(t17.amount), 0) >= 0 OR accounts_actual1.account_type = 'C' AND COALESCE(SUM(t17.amount), 0) <= 0 THEN 'OK' ELSE 'NOT OK' END AS __f3 FROM local__shares.accounts_actual AS accounts_actual1 LEFT JOIN (SELECT transaction_id, transaction_date, account_id, amount, sys_op, sys_to, sys_from, sign, sys_close_date FROM local__shares.transactions_actual_shard WHERE sys_from <= 1 AND sys_to >= 1) AS t17 ON accounts_actual1.account_id = t17.account_id WHERE accounts_actual1.sys_from <= 1 AND accounts_actual1.sys_to >= 1 GROUP BY accounts_actual1.account_id, accounts_actual1.account_type) AS t22 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NULL AND (((SELECT 1 AS r FROM local__shares.transactions_actual_shard WHERE sign < 0 LIMIT 1))) IS NULL",
  "enrichWithDeltaNum4": "SELECT transaction_id, transaction_date, account_id, amount FROM (SELECT transaction_id, transaction_date, account_id, amount, sys_op, sys_to, sys_from, sign, sys_close_date FROM (SELECT transaction_id, transaction_date, account_id, amount, sys_op, sys_to, sys_from, sign, sys_close_date FROM local__shares.transactions_actual FINAL WHERE sys_from <= 1 AND sys_to >= 1) AS t0 WHERE (((SELECT 1 AS r FROM local__shares.transactions_actual WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT transaction_id, transaction_date, account_id, amount, sys_op, sys_to, sys_from, sign, sys_close_date FROM (SELECT transaction_id, transaction_date, account_id, amount, sys_op, sys_to, sys_from, sign, sys_close_date FROM local__shares.transactions_actual WHERE sys_from <= 1 AND sys_to >= 1) AS t8 WHERE (((SELECT 1 AS r FROM local__shares.transactions_actual WHERE sign < 0 LIMIT 1))) IS NULL) AS t15",
  "enrichWithDeltaNum5": "SELECT account_id FROM (SELECT t1.account_id FROM (SELECT account_id FROM local__shares.accounts_actual FINAL WHERE sys_from <= 1 AND (sys_to >= 1 AND account_id = 12)) AS t1 INNER JOIN local__shares.transactions_actual_shard FINAL ON t1.account_id = transactions_actual_shard.account_id WHERE transactions_actual_shard.sys_from <= 1 AND transactions_actual_shard.sys_to >= 1) AS t4 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NOT NULL OR (((SELECT 1 AS r FROM local__shares.transactions_actual_shard WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT account_id FROM (SELECT t17.account_id FROM (SELECT account_id FROM local__shares.accounts_actual WHERE sys_from <= 1 AND (sys_to >= 1 AND account_id = 12)) AS t17 INNER JOIN local__shares.transactions_actual_shard AS transactions_actual_shard1 ON t17.account_id = transactions_actual_shard1.account_id WHERE transactions_actual_shard1.sys_from <= 1 AND transactions_actual_shard1.sys_to >= 1) AS t20 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NULL AND (((SELECT 1 AS r FROM local__shares.transactions_actual_shard WHERE sign < 0 LIMIT 1))) IS NULL",
  "enrichWithDeltaNum6": "SELECT account_id FROM (SELECT accounts_actual.account_id FROM local__shares.accounts_actual FINAL INNER JOIN (SELECT transaction_id, transaction_date, account_id, amount, sys_op, sys_to, sys_from, sign, sys_close_date FROM local__shares.transactions_actual_shard FINAL WHERE sys_from <= 1 AND sys_to >= 1) AS t0 ON accounts_actual.account_id = t0.account_id WHERE accounts_actual.sys_from <= 1 AND accounts_actual.sys_to >= 1 LIMIT 10) AS t4 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NOT NULL OR (((SELECT 1 AS r FROM local__shares.transactions_actual_shard WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT account_id FROM (SELECT accounts_actual1.account_id FROM local__shares.accounts_actual AS accounts_actual1 INNER JOIN (SELECT transaction_id, transaction_date, account_id, amount, sys_op, sys_to, sys_from, sign, sys_close_date FROM local__shares.transactions_actual_shard WHERE sys_from <= 1 AND sys_to >= 1) AS t16 ON accounts_actual1.account_id = t16.account_id WHERE accounts_actual1.sys_from <= 1 AND accounts_actual1.sys_to >= 1 LIMIT 10) AS t20 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NULL AND (((SELECT 1 AS r FROM local__shares.transactions_actual_shard WHERE sign < 0 LIMIT 1))) IS NULL",
  "enrichCount": "SELECT COUNT(*) AS EXPR__0 FROM (SELECT __f0 FROM (SELECT 0 AS __f0 FROM local__shares.accounts_actual FINAL WHERE sys_from <= 1 AND sys_to >= 1) AS t1 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT __f0 FROM (SELECT 0 AS __f0 FROM local__shares.accounts_actual WHERE sys_from <= 1 AND sys_to >= 1) AS t10 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NULL) AS t17",
  "enrichWithDeltaNum9": "SELECT transaction_id, transaction_date, account_id, amount FROM (SELECT transaction_id, transaction_date, account_id, amount, sys_op, sys_to, sys_from, sign, sys_close_date FROM (SELECT transaction_id, transaction_date, account_id, amount, sys_op, sys_to, sys_from, sign, sys_close_date FROM local__shares.transactions_actual FINAL WHERE sys_from <= 1 AND (sys_to >= 1 AND account_id = 1)) AS t0 WHERE (((SELECT 1 AS r FROM local__shares.transactions_actual WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT transaction_id, transaction_date, account_id, amount, sys_op, sys_to, sys_from, sign, sys_close_date FROM (SELECT transaction_id, transaction_date, account_id, amount, sys_op, sys_to, sys_from, sign, sys_close_date FROM local__shares.transactions_actual WHERE sys_from <= 1 AND (sys_to >= 1 AND account_id = 1)) AS t8 WHERE (((SELECT 1 AS r FROM local__shares.transactions_actual WHERE sign < 0 LIMIT 1))) IS NULL) AS t15",
  "enrichWithAggregate": "SELECT min_col, max_col, varchar_col FROM (SELECT MIN(int_col) AS min_col, MIN(double_col) AS max_col, varchar_col FROM local__dml.aggregation_table_actual FINAL WHERE sys_from <= 1 AND sys_to >= 1 GROUP BY varchar_col ORDER BY varchar_col NULLS LAST LIMIT 2) AS t5 WHERE (((SELECT 1 AS r FROM local__dml.aggregation_table_actual WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT min_col, max_col, varchar_col FROM (SELECT MIN(int_col) AS min_col, MIN(double_col) AS max_col, varchar_col FROM local__dml.aggregation_table_actual WHERE sys_from <= 1 AND sys_to >= 1 GROUP BY varchar_col ORDER BY varchar_col NULLS LAST LIMIT 2) AS t18 WHERE (((SELECT 1 AS r FROM local__dml.aggregation_table_actual WHERE sign < 0 LIMIT 1))) IS NULL",
  "enrichWithAggregate2": "SELECT min_col, max_col, varchar_col, __f3 FROM (SELECT MIN(int_col) AS min_col, MIN(double_col) AS max_col, varchar_col, NULL AS __f3 FROM local__dml.aggregation_table_actual FINAL WHERE sys_from <= 1 AND (sys_to >= 1 AND varchar_col = 'ф') GROUP BY varchar_col LIMIT 2) AS t4 WHERE (((SELECT 1 AS r FROM local__dml.aggregation_table_actual WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT min_col, max_col, varchar_col, __f3 FROM (SELECT MIN(int_col) AS min_col, MIN(double_col) AS max_col, varchar_col, NULL AS __f3 FROM local__dml.aggregation_table_actual WHERE sys_from <= 1 AND (sys_to >= 1 AND varchar_col = 'ф') GROUP BY varchar_col LIMIT 2) AS t16 WHERE (((SELECT 1 AS r FROM local__dml.aggregation_table_actual WHERE sign < 0 LIMIT 1))) IS NULL",
  "enrichWithSort": "SELECT EXPR__0, category_name, EXPR__2, id0 FROM (SELECT COUNT(t0.category_name) AS EXPR__0, t0.category_name, SUM(products_actual.units_in_stock) AS EXPR__2, t0.id AS id0 FROM local__dml.products_actual FINAL INNER JOIN (SELECT id, category_name, description, sys_op, sys_to, sys_from, sign, sys_close_date FROM local__dml.categories_actual_shard FINAL WHERE sys_from <= 1 AND sys_to >= 1) AS t0 ON products_actual.category_id = t0.id WHERE products_actual.sys_from <= 1 AND products_actual.sys_to >= 1 GROUP BY t0.category_name, t0.id ORDER BY t0.id NULLS LAST LIMIT 5) AS t7 WHERE (((SELECT 1 AS r FROM local__dml.products_actual WHERE sign < 0 LIMIT 1))) IS NOT NULL OR (((SELECT 1 AS r FROM local__dml.categories_actual_shard WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT EXPR__0, category_name, EXPR__2, id0 FROM (SELECT COUNT(t19.category_name) AS EXPR__0, t19.category_name, SUM(products_actual1.units_in_stock) AS EXPR__2, t19.id AS id0 FROM local__dml.products_actual AS products_actual1 INNER JOIN (SELECT id, category_name, description, sys_op, sys_to, sys_from, sign, sys_close_date FROM local__dml.categories_actual_shard WHERE sys_from <= 1 AND sys_to >= 1) AS t19 ON products_actual1.category_id = t19.id WHERE products_actual1.sys_from <= 1 AND products_actual1.sys_to >= 1 GROUP BY t19.category_name, t19.id ORDER BY t19.id NULLS LAST LIMIT 5) AS t26 WHERE (((SELECT 1 AS r FROM local__dml.products_actual WHERE sign < 0 LIMIT 1))) IS NULL AND (((SELECT 1 AS r FROM local__dml.categories_actual_shard WHERE sign < 0 LIMIT 1))) IS NULL",
  "enrichWithSort3": "SELECT EXPR__0, category_name, id0, EXPR__3 FROM (SELECT COUNT(t0.category_name) AS EXPR__0, t0.category_name, t0.id AS id0, SUM(products_actual.units_in_stock) AS EXPR__3 FROM local__dml.products_actual FINAL INNER JOIN (SELECT id, category_name, description, sys_op, sys_to, sys_from, sign, sys_close_date FROM local__dml.categories_actual_shard FINAL WHERE sys_from <= 1 AND sys_to >= 1) AS t0 ON products_actual.category_id = t0.id WHERE products_actual.sys_from <= 1 AND products_actual.sys_to >= 1 GROUP BY t0.category_name, t0.id ORDER BY t0.id NULLS LAST LIMIT 5) AS t7 WHERE (((SELECT 1 AS r FROM local__dml.products_actual WHERE sign < 0 LIMIT 1))) IS NOT NULL OR (((SELECT 1 AS r FROM local__dml.categories_actual_shard WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT EXPR__0, category_name, id0, EXPR__3 FROM (SELECT COUNT(t19.category_name) AS EXPR__0, t19.category_name, t19.id AS id0, SUM(products_actual1.units_in_stock) AS EXPR__3 FROM local__dml.products_actual AS products_actual1 INNER JOIN (SELECT id, category_name, description, sys_op, sys_to, sys_from, sign, sys_close_date FROM local__dml.categories_actual_shard WHERE sys_from <= 1 AND sys_to >= 1) AS t19 ON products_actual1.category_id = t19.id WHERE products_actual1.sys_from <= 1 AND products_actual1.sys_to >= 1 GROUP BY t19.category_name, t19.id ORDER BY t19.id NULLS LAST LIMIT 5) AS t26 WHERE (((SELECT 1 AS r FROM local__dml.products_actual WHERE sign < 0 LIMIT 1))) IS NULL AND (((SELECT 1 AS r FROM local__dml.categories_actual_shard WHERE sign < 0 LIMIT 1))) IS NULL",
  "enrichWithSort4": "SELECT EXPR__0, EXPR__1 FROM (SELECT t7.EXPR__0, t7.EXPR__1 FROM (SELECT COUNT(t0.category_name) AS EXPR__0, SUM(products_actual.units_in_stock) AS EXPR__1, t0.id AS id0 FROM local__dml.products_actual FINAL INNER JOIN (SELECT id, category_name, description, sys_op, sys_to, sys_from, sign, sys_close_date FROM local__dml.categories_actual_shard FINAL WHERE sys_from <= 1 AND sys_to >= 1) AS t0 ON products_actual.category_id = t0.id WHERE products_actual.sys_from <= 1 AND products_actual.sys_to >= 1 GROUP BY t0.category_name, t0.id ORDER BY t0.id NULLS LAST LIMIT 5) AS t7) AS t8 WHERE (((SELECT 1 AS r FROM local__dml.products_actual WHERE sign < 0 LIMIT 1))) IS NOT NULL OR (((SELECT 1 AS r FROM local__dml.categories_actual_shard WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT EXPR__0, EXPR__1 FROM (SELECT t27.EXPR__0, t27.EXPR__1 FROM (SELECT COUNT(t20.category_name) AS EXPR__0, SUM(products_actual1.units_in_stock) AS EXPR__1, t20.id AS id0 FROM local__dml.products_actual AS products_actual1 INNER JOIN (SELECT id, category_name, description, sys_op, sys_to, sys_from, sign, sys_close_date FROM local__dml.categories_actual_shard WHERE sys_from <= 1 AND sys_to >= 1) AS t20 ON products_actual1.category_id = t20.id WHERE products_actual1.sys_from <= 1 AND products_actual1.sys_to >= 1 GROUP BY t20.category_name, t20.id ORDER BY t20.id NULLS LAST LIMIT 5) AS t27) AS t28 WHERE (((SELECT 1 AS r FROM local__dml.products_actual WHERE sign < 0 LIMIT 1))) IS NULL AND (((SELECT 1 AS r FROM local__dml.categories_actual_shard WHERE sign < 0 LIMIT 1))) IS NULL",
  "enrichWithSort5": "SELECT id0 FROM (SELECT t0.id AS id0 FROM local__dml.products_actual FINAL INNER JOIN (SELECT id, category_name, description, sys_op, sys_to, sys_from, sign, sys_close_date FROM local__dml.categories_actual_shard FINAL WHERE sys_from <= 1 AND sys_to >= 1) AS t0 ON products_actual.category_id = t0.id WHERE products_actual.sys_from <= 1 AND products_actual.sys_to >= 1 ORDER BY t0.id NULLS LAST) AS t4 WHERE (((SELECT 1 AS r FROM local__dml.products_actual WHERE sign < 0 LIMIT 1))) IS NOT NULL OR (((SELECT 1 AS r FROM local__dml.categories_actual_shard WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT id0 FROM (SELECT t16.id AS id0 FROM local__dml.products_actual AS products_actual1 INNER JOIN (SELECT id, category_name, description, sys_op, sys_to, sys_from, sign, sys_close_date FROM local__dml.categories_actual_shard WHERE sys_from <= 1 AND sys_to >= 1) AS t16 ON products_actual1.category_id = t16.id WHERE products_actual1.sys_from <= 1 AND products_actual1.sys_to >= 1 ORDER BY t16.id NULLS LAST) AS t20 WHERE (((SELECT 1 AS r FROM local__dml.products_actual WHERE sign < 0 LIMIT 1))) IS NULL AND (((SELECT 1 AS r FROM local__dml.categories_actual_shard WHERE sign < 0 LIMIT 1))) IS NULL",
  "enrichWithSort6": "SELECT id, category_name, description, id0, product_name, category_id, unit_price, units_in_stock, discontinued FROM (SELECT id, category_name, description, sys_op, sys_to, sys_from, sign, sys_close_date, id0, product_name, category_id, unit_price, units_in_stock, discontinued, sys_op0, sys_to0, sys_from0, sign0, sys_close_date0 FROM (SELECT categories_actual.id, categories_actual.category_name, categories_actual.description, categories_actual.sys_op, categories_actual.sys_to, categories_actual.sys_from, categories_actual.sign, categories_actual.sys_close_date, t0.id AS id0, t0.product_name, t0.category_id, t0.unit_price, t0.units_in_stock, t0.discontinued, t0.sys_op AS sys_op0, t0.sys_to AS sys_to0, t0.sys_from AS sys_from0, t0.sign AS sign0, t0.sys_close_date AS sys_close_date0 FROM local__dml.categories_actual FINAL INNER JOIN (SELECT id, product_name, category_id, unit_price, units_in_stock, discontinued, sys_op, sys_to, sys_from, sign, sys_close_date FROM local__dml.products_actual_shard FINAL WHERE sys_from <= 1 AND sys_to >= 1) AS t0 ON categories_actual.id = t0.category_id WHERE categories_actual.sys_from <= 1 AND categories_actual.sys_to >= 1 ORDER BY categories_actual.id NULLS LAST, t0.product_name DESC NULLS FIRST) AS t3 WHERE (((SELECT 1 AS r FROM local__dml.categories_actual WHERE sign < 0 LIMIT 1))) IS NOT NULL OR (((SELECT 1 AS r FROM local__dml.products_actual_shard WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT id, category_name, description, sys_op, sys_to, sys_from, sign, sys_close_date, id0, product_name, category_id, unit_price, units_in_stock, discontinued, sys_op0, sys_to0, sys_from0, sign0, sys_close_date0 FROM (SELECT categories_actual1.id, categories_actual1.category_name, categories_actual1.description, categories_actual1.sys_op, categories_actual1.sys_to, categories_actual1.sys_from, categories_actual1.sign, categories_actual1.sys_close_date, t15.id AS id0, t15.product_name, t15.category_id, t15.unit_price, t15.units_in_stock, t15.discontinued, t15.sys_op AS sys_op0, t15.sys_to AS sys_to0, t15.sys_from AS sys_from0, t15.sign AS sign0, t15.sys_close_date AS sys_close_date0 FROM local__dml.categories_actual AS categories_actual1 INNER JOIN (SELECT id, product_name, category_id, unit_price, units_in_stock, discontinued, sys_op, sys_to, sys_from, sign, sys_close_date FROM local__dml.products_actual_shard WHERE sys_from <= 1 AND sys_to >= 1) AS t15 ON categories_actual1.id = t15.category_id WHERE categories_actual1.sys_from <= 1 AND categories_actual1.sys_to >= 1 ORDER BY categories_actual1.id NULLS LAST, t15.product_name DESC NULLS FIRST) AS t18 WHERE (((SELECT 1 AS r FROM local__dml.categories_actual WHERE sign < 0 LIMIT 1))) IS NULL AND (((SELECT 1 AS r FROM local__dml.products_actual_shard WHERE sign < 0 LIMIT 1))) IS NULL) AS t29",
  "enrichWithManyInKeyword": "SELECT account_id FROM (SELECT account_id FROM local__shares.accounts_actual FINAL WHERE sys_from <= 1 AND (sys_to >= 1 AND (account_id = 1 OR account_id = 2 OR (account_id = 3 OR (account_id = 4 OR account_id = 5)) OR (account_id = 6 OR (account_id = 7 OR account_id = 8) OR (account_id = 9 OR (account_id = 10 OR account_id = 11))) OR (account_id = 12 OR (account_id = 13 OR account_id = 14) OR (account_id = 15 OR (account_id = 16 OR account_id = 17)) OR (account_id = 18 OR (account_id = 19 OR account_id = 20) OR (account_id = 21 OR (account_id = 22 OR account_id = 23))))))) AS t1 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT account_id FROM (SELECT account_id FROM local__shares.accounts_actual WHERE sys_from <= 1 AND (sys_to >= 1 AND (account_id = 1 OR account_id = 2 OR (account_id = 3 OR (account_id = 4 OR account_id = 5)) OR (account_id = 6 OR (account_id = 7 OR account_id = 8) OR (account_id = 9 OR (account_id = 10 OR account_id = 11))) OR (account_id = 12 OR (account_id = 13 OR account_id = 14) OR (account_id = 15 OR (account_id = 16 OR account_id = 17)) OR (account_id = 18 OR (account_id = 19 OR account_id = 20) OR (account_id = 21 OR (account_id = 22 OR account_id = 23))))))) AS t10 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NULL",
  "enrichWithCustomSelect": "SELECT account_id, account_type, __f7 FROM (SELECT account_id, account_type, sys_op, sys_to, sys_from, sign, sys_close_date, __f7 FROM (SELECT account_id, account_type, sys_op, sys_to, sys_from, sign, sys_close_date, 0 AS __f7 FROM local__shares.accounts_actual FINAL WHERE sys_from <= 1 AND sys_to >= 1 ORDER BY account_id NULLS LAST) AS t2 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT account_id, account_type, sys_op, sys_to, sys_from, sign, sys_close_date, __f7 FROM (SELECT account_id, account_type, sys_op, sys_to, sys_from, sign, sys_close_date, 0 AS __f7 FROM local__shares.accounts_actual WHERE sys_from <= 1 AND sys_to >= 1 ORDER BY account_id NULLS LAST) AS t12 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NULL) AS t19",
  "enrichWithSubquery": "SELECT account_id, account_type FROM (SELECT account_id, account_type, sys_op, sys_to, sys_from, sign, sys_close_date FROM (SELECT account_id, account_type, sys_op, sys_to, sys_from, sign, sys_close_date FROM local__shares.accounts_actual FINAL WHERE sys_from <= 1 AND (sys_to >= 1 AND account_id IN (SELECT account_id FROM local__shares.transactions_actual_shard FINAL WHERE sys_from <= 2 AND sys_to >= 2 LIMIT 1))) AS t4 WHERE (((SELECT 1 AS r FROM local__shares.transactions_actual_shard WHERE sign < 0 LIMIT 1))) IS NOT NULL OR (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT account_id, account_type, sys_op, sys_to, sys_from, sign, sys_close_date FROM (SELECT account_id, account_type, sys_op, sys_to, sys_from, sign, sys_close_date FROM local__shares.accounts_actual WHERE sys_from <= 1 AND (sys_to >= 1 AND account_id IN (SELECT account_id FROM local__shares.transactions_actual_shard WHERE sys_from <= 2 AND sys_to >= 2 LIMIT 1))) AS t20 WHERE (((SELECT 1 AS r FROM local__shares.transactions_actual_shard WHERE sign < 0 LIMIT 1))) IS NULL AND (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NULL) AS t31",
  "enrichWithSubqueryInJoin": "SELECT account_id, account_type, account_id0 FROM (SELECT account_id, account_type, sys_op, sys_to, sys_from, sign, sys_close_date, account_id0 FROM (SELECT accounts_actual.account_id, accounts_actual.account_type, accounts_actual.sys_op, accounts_actual.sys_to, accounts_actual.sys_from, accounts_actual.sign, accounts_actual.sys_close_date, t1.account_id AS account_id0 FROM local__shares.accounts_actual FINAL INNER JOIN (SELECT account_id FROM local__shares.transactions_actual_shard FINAL WHERE sys_from <= 2 AND sys_to >= 2) AS t1 ON accounts_actual.account_id = t1.account_id WHERE accounts_actual.account_id > 0 AND (accounts_actual.sys_from <= 1 AND accounts_actual.sys_to >= 1) LIMIT 1) AS t4 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NOT NULL OR (((SELECT 1 AS r FROM local__shares.transactions_actual_shard WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT account_id, account_type, sys_op, sys_to, sys_from, sign, sys_close_date, account_id0 FROM (SELECT accounts_actual1.account_id, accounts_actual1.account_type, accounts_actual1.sys_op, accounts_actual1.sys_to, accounts_actual1.sys_from, accounts_actual1.sign, accounts_actual1.sys_close_date, t17.account_id AS account_id0 FROM local__shares.accounts_actual AS accounts_actual1 INNER JOIN (SELECT account_id FROM local__shares.transactions_actual_shard WHERE sys_from <= 2 AND sys_to >= 2) AS t17 ON accounts_actual1.account_id = t17.account_id WHERE accounts_actual1.account_id > 0 AND (accounts_actual1.sys_from <= 1 AND accounts_actual1.sys_to >= 1) LIMIT 1) AS t20 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NULL AND (((SELECT 1 AS r FROM local__shares.transactions_actual_shard WHERE sign < 0 LIMIT 1))) IS NULL) AS t31",
  "enrichWithDeltaFinishedIn": "SELECT account_id FROM (SELECT accounts_actual.account_id FROM local__shares.accounts_actual FINAL INNER JOIN (SELECT transaction_id, transaction_date, account_id, amount, sys_op, sys_to, sys_from, sign, sys_close_date FROM local__shares.transactions_actual_shard FINAL WHERE sys_to >= 1 AND (sys_to <= 1 AND sys_op = 1)) AS t0 ON accounts_actual.account_id = t0.account_id WHERE accounts_actual.account_id = 10 AND accounts_actual.sys_to >= 0 AND (accounts_actual.sys_to <= 0 AND accounts_actual.sys_op = 1)) AS t3 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NOT NULL OR (((SELECT 1 AS r FROM local__shares.transactions_actual_shard WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT account_id FROM (SELECT accounts_actual1.account_id FROM local__shares.accounts_actual AS accounts_actual1 INNER JOIN (SELECT transaction_id, transaction_date, account_id, amount, sys_op, sys_to, sys_from, sign, sys_close_date FROM local__shares.transactions_actual_shard WHERE sys_to >= 1 AND (sys_to <= 1 AND sys_op = 1)) AS t15 ON accounts_actual1.account_id = t15.account_id WHERE accounts_actual1.account_id = 10 AND accounts_actual1.sys_to >= 0 AND (accounts_actual1.sys_to <= 0 AND accounts_actual1.sys_op = 1)) AS t18 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NULL AND (((SELECT 1 AS r FROM local__shares.transactions_actual_shard WHERE sign < 0 LIMIT 1))) IS NULL",
  "enrichWithDeltaStartedIn": "SELECT account_id FROM (SELECT accounts_actual.account_id FROM local__shares.accounts_actual FINAL INNER JOIN (SELECT transaction_id, transaction_date, account_id, amount, sys_op, sys_to, sys_from, sign, sys_close_date FROM local__shares.transactions_actual_shard FINAL WHERE sys_from >= 2 AND sys_from <= 2) AS t0 ON accounts_actual.account_id = t0.account_id WHERE accounts_actual.account_id = 10 AND (accounts_actual.sys_from >= 1 AND accounts_actual.sys_from <= 1)) AS t3 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NOT NULL OR (((SELECT 1 AS r FROM local__shares.transactions_actual_shard WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT account_id FROM (SELECT accounts_actual1.account_id FROM local__shares.accounts_actual AS accounts_actual1 INNER JOIN (SELECT transaction_id, transaction_date, account_id, amount, sys_op, sys_to, sys_from, sign, sys_close_date FROM local__shares.transactions_actual_shard WHERE sys_from >= 2 AND sys_from <= 2) AS t15 ON accounts_actual1.account_id = t15.account_id WHERE accounts_actual1.account_id = 10 AND (accounts_actual1.sys_from >= 1 AND accounts_actual1.sys_from <= 1)) AS t18 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NULL AND (((SELECT 1 AS r FROM local__shares.transactions_actual_shard WHERE sign < 0 LIMIT 1))) IS NULL",
  "enrichWithDeltaOnDate": "SELECT account_id FROM (SELECT accounts_actual.account_id FROM local__shares.accounts_actual FINAL INNER JOIN (SELECT transaction_id, transaction_date, account_id, amount, sys_op, sys_to, sys_from, sign, sys_close_date FROM local__shares.transactions_actual_shard FINAL WHERE sys_from <= 2 AND sys_to >= 2) AS t0 ON accounts_actual.account_id = t0.account_id WHERE accounts_actual.account_id = 10 AND (accounts_actual.sys_from <= 1 AND accounts_actual.sys_to >= 1)) AS t3 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NOT NULL OR (((SELECT 1 AS r FROM local__shares.transactions_actual_shard WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT account_id FROM (SELECT accounts_actual1.account_id FROM local__shares.accounts_actual AS accounts_actual1 INNER JOIN (SELECT transaction_id, transaction_date, account_id, amount, sys_op, sys_to, sys_from, sign, sys_close_date FROM local__shares.transactions_actual_shard WHERE sys_from <= 2 AND sys_to >= 2) AS t15 ON accounts_actual1.account_id = t15.account_id WHERE accounts_actual1.account_id = 10 AND (accounts_actual1.sys_from <= 1 AND accounts_actual1.sys_to >= 1)) AS t18 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NULL AND (((SELECT 1 AS r FROM local__shares.transactions_actual_shard WHERE sign < 0 LIMIT 1))) IS NULL",
  "enrichWithWithoutDelta": "SELECT account_id FROM (SELECT accounts_actual.account_id FROM local__shares.accounts_actual FINAL INNER JOIN (SELECT transaction_id, transaction_date, account_id, amount, sys_op, sys_to, sys_from, sign, sys_close_date FROM local__shares.transactions_actual_shard FINAL WHERE sys_from <= 2 AND sys_to >= 2) AS t0 ON accounts_actual.account_id = t0.account_id WHERE accounts_actual.account_id = 10 AND (accounts_actual.sys_from <= 1 AND accounts_actual.sys_to >= 1)) AS t3 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NOT NULL OR (((SELECT 1 AS r FROM local__shares.transactions_actual_shard WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT account_id FROM (SELECT accounts_actual1.account_id FROM local__shares.accounts_actual AS accounts_actual1 INNER JOIN (SELECT transaction_id, transaction_date, account_id, amount, sys_op, sys_to, sys_from, sign, sys_close_date FROM local__shares.transactions_actual_shard WHERE sys_from <= 2 AND sys_to >= 2) AS t15 ON accounts_actual1.account_id = t15.account_id WHERE accounts_actual1.account_id = 10 AND (accounts_actual1.sys_from <= 1 AND accounts_actual1.sys_to >= 1)) AS t18 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NULL AND (((SELECT 1 AS r FROM local__shares.transactions_actual_shard WHERE sign < 0 LIMIT 1))) IS NULL",
  "enrichWithAliasesAndFunctions": "SELECT account_id, __f1, __f2, __f3, __f4, transaction_id, transaction_date, account_id0, amount FROM (SELECT account_id, __f1, __f2, __f3, __f4, transaction_id, transaction_date, account_id0, amount, sys_op, sys_to, sys_from, sign, sys_close_date FROM (SELECT account_id, __f1, __f2, __f3, __f4, transaction_id, transaction_date, account_id0, amount, sys_op, sys_to, sys_from, sign, sys_close_date FROM (SELECT t1.account_id, t1.__f1, t1.__f2, t1.__f3, t1.__f4, t4.transaction_id, t4.transaction_date, t4.account_id AS account_id0, t4.amount, t4.sys_op, t4.sys_to, t4.sys_from, t4.sign, t4.sys_close_date FROM (SELECT account_id, TRUE AS __f1, ABS(account_id) AS __f2, 'some$' AS __f3, '$some' AS __f4 FROM local__shares.accounts_actual FINAL WHERE sys_from <= 2 AND sys_to >= 2) AS t1 INNER JOIN (SELECT transaction_id, transaction_date, account_id, amount, sys_op, sys_to, sys_from, sign, sys_close_date, ABS(account_id) AS __f9 FROM local__shares.transactions_actual_shard FINAL WHERE sys_from <= 1 AND sys_to >= 1) AS t4 ON t1.account_id = t4.account_id AND t1.__f2 = t4.__f9) AS t5 WHERE t5.__f1 = TRUE AND t5.__f2 = 0) AS t7 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NOT NULL OR (((SELECT 1 AS r FROM local__shares.transactions_actual_shard WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT account_id, __f1, __f2, __f3, __f4, transaction_id, transaction_date, account_id0, amount, sys_op, sys_to, sys_from, sign, sys_close_date FROM (SELECT account_id, __f1, __f2, __f3, __f4, transaction_id, transaction_date, account_id0, amount, sys_op, sys_to, sys_from, sign, sys_close_date FROM (SELECT t20.account_id, t20.__f1, t20.__f2, t20.__f3, t20.__f4, t23.transaction_id, t23.transaction_date, t23.account_id AS account_id0, t23.amount, t23.sys_op, t23.sys_to, t23.sys_from, t23.sign, t23.sys_close_date FROM (SELECT account_id, TRUE AS __f1, ABS(account_id) AS __f2, 'some$' AS __f3, '$some' AS __f4 FROM local__shares.accounts_actual WHERE sys_from <= 2 AND sys_to >= 2) AS t20 INNER JOIN (SELECT transaction_id, transaction_date, account_id, amount, sys_op, sys_to, sys_from, sign, sys_close_date, ABS(account_id) AS __f9 FROM local__shares.transactions_actual_shard WHERE sys_from <= 1 AND sys_to >= 1) AS t23 ON t20.account_id = t23.account_id AND t20.__f2 = t23.__f9) AS t24 WHERE t24.__f1 = TRUE AND t24.__f2 = 0) AS t26 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual WHERE sign < 0 LIMIT 1))) IS NULL AND (((SELECT 1 AS r FROM local__shares.transactions_actual_shard WHERE sign < 0 LIMIT 1))) IS NULL) AS t37",
  "shouldBeShardedWhenLocal": "SELECT account_id FROM (SELECT accounts_actual_shard.account_id FROM local__shares.accounts_actual_shard FINAL INNER JOIN (SELECT transaction_id, transaction_date, account_id, amount, sys_op, sys_to, sys_from, sign, sys_close_date FROM local__shares.transactions_actual_shard FINAL WHERE sys_from <= 1 AND sys_to >= 1) AS t0 ON accounts_actual_shard.account_id = t0.account_id WHERE accounts_actual_shard.account_id = 10 AND (accounts_actual_shard.sys_from <= 1 AND accounts_actual_shard.sys_to >= 1)) AS t3 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual_shard WHERE sign < 0 LIMIT 1))) IS NOT NULL OR (((SELECT 1 AS r FROM local__shares.transactions_actual_shard WHERE sign < 0 LIMIT 1))) IS NOT NULL UNION ALL SELECT account_id FROM (SELECT accounts_actual_shard1.account_id FROM local__shares.accounts_actual_shard AS accounts_actual_shard1 INNER JOIN (SELECT transaction_id, transaction_date, account_id, amount, sys_op, sys_to, sys_from, sign, sys_close_date FROM local__shares.transactions_actual_shard WHERE sys_from <= 1 AND sys_to >= 1) AS t15 ON accounts_actual_shard1.account_id = t15.account_id WHERE accounts_actual_shard1.account_id = 10 AND (accounts_actual_shard1.sys_from <= 1 AND accounts_actual_shard1.sys_to >= 1)) AS t18 WHERE (((SELECT 1 AS r FROM local__shares.accounts_actual_shard WHERE sign < 0 LIMIT 1))) IS NULL AND (((SELECT 1 AS r FROM local__shares.transactions_actual_shard WHERE sign < 0 LIMIT 1))) IS NULL"
}